# Marketing Field Mapping (Simplified Core)

> Эта таблица покрывает базовую модель из гипотез A и B. Если используете расширенный вариант (гипотеза C), добавьте поля из `complete_field_structure.json` и `fields_creation_checklist.csv`.

## Основные стандартные поля Bitrix24

| Слой модели | Поле | Источник данных | Как заполняем | Назначение |
| --- | --- | --- | --- | --- |
| Категория канала | `SOURCE_ID` | Автоматизации и ручной выбор менеджера | Используем встроенный список `ADVERTISING/WEB/PARTNER/RECOMMENDATION/EMAIL/CALL/OTHER`. | Верхнеуровневая категоризация для стандартных отчётов и фильтров. |
| Тип трафика | `UTM_MEDIUM` | Веб-формы, UIS, автоскрипты | Принимаем значение из URL или автологики, далее роботы нормализуют категорию. | Позволяет отличать платный/органический/соцканал без кастомного списка. |
| Конкретный источник | `UTM_SOURCE` | Веб-формы, UIS webhook | Передаём оригинальное значение (google_ads, instagram_oleynik, napopravku). | Сохраняет идентификатор площадки для ROI и назначения. |
| Кампания и детализация | `UTM_CAMPAIGN`, `UTM_CONTENT`, `UTM_TERM` | Веб-формы и импорт | Принимаем строковые значения без дополнительной нормализации. | Дополнительный срез по кампаниям, объявлениям и ключевым словам. |

## Минимальные дополнительные поля

| Поле | Тип | Зачем оставляем | Комментарий |
| --- | --- | --- | --- |
| `UF_CRM_CONTACT_METHOD` | Список | Фиксирует фактический канал коммуникации (звонок, WhatsApp, Instagram и т.д.), без него невозможно отделить «как обратились». | Поле уже используется в сделках и лидах, достаточно актуализировать значения и спрятать излишние для менеджеров. |
| `UF_SOURCE_DESCRIPTION` *(опционально)* | Текст | Автоматически собирает читабельное описание источника для аналитиков и проверок. | Если нужна максимальная простота, можно сгенерировать значение в отчётах и оставить поле скрытым. |

## Как маппить каналы при упрощённой модели

1. В веб-формах сохраняем текущий JavaScript для заполнения `utm_*` параметров и направляем их в стандартные поля вместо пользовательских.
2. UIS вебхуки заполняют `UTM_SOURCE/UTM_MEDIUM` и номер канала; автоматизация продолжает нормализовать `SOURCE_ID` и, при необходимости, подставляет способ обращения в `UF_CRM_CONTACT_METHOD`.
3. Роботы распределения ответственных могут читать `UTM_SOURCE`/`UTM_CAMPAIGN` и при необходимости обновлять `UF_SOURCE_DESCRIPTION` для аналитиков.

> Под расширенную модель добавляйте поля для домена, реферера, ответственного по каналу и типа клиента. Их перечень и статусы — в `docs/audit_report.md` и `bitrix24_implementation_checklist.json`.
